!function(){function e(e){v.publish({channel:p,message:e})}function t(e,t){d.strokeStyle=e,d.beginPath(),d.moveTo(t[0].x,t[0].y);for(var n=1;n<t.length;n++)d.lineTo(t[n].x,t[n].y);d.stroke()}function n(e){!e||e.plots.length<1||t(e.color,e.plots)}function o(e){if(e.preventDefault(),y){var n=u?e.targetTouches[0].pageX-i.offsetLeft:e.offsetX||e.layerX-i.offsetLeft,o=u?e.targetTouches[0].pageY-i.offsetTop:e.offsetY||e.layerY-i.offsetTop;b.push({x:n<<0,y:o<<0}),t(r,b)}}function c(e){e.preventDefault(),y=!0}function a(t){t.preventDefault(),y=!1,e({color:r,plots:b}),b=[]}var i=document.getElementById("drawCanvas"),d=i.getContext("2d"),r=document.querySelector(":checked").getAttribute("data-color");i.width=Math.min(document.documentElement.clientWidth,window.innerWidth||300),i.height=Math.min(document.documentElement.clientHeight,window.innerHeight||300),d.strokeStyle=r,d.lineWidth="3",d.lineCap=d.lineJoin="round",document.getElementById("colorSwatch").addEventListener("click",function(){r=document.querySelector(":checked").getAttribute("data-color")},!1);var u="ontouchstart"in window,l=navigator.pointerEnabled,s=navigator.msPointerEnabled,f=u?"touchstart":l?"pointerdown":s?"MSPointerDown":"mousedown",m=u?"touchmove":l?"pointermove":s?"MSPointerMove":"mousemove",h=u?"touchend":l?"pointerup":s?"MSPointerUp":"mouseup";i.addEventListener(f,c,!1),i.addEventListener(m,o,!1),i.addEventListener(h,a,!1);var p="draw",v=PUBNUB.init({publish_key:"pub-c-156a6d5f-22bd-4a13-848d-b5b4d4b36695",subscribe_key:"sub-c-f762fb78-2724-11e4-a4df-02ee2ddab7fe",leave_on_unload:!0,ssl:"https:"===document.location.protocol});v.subscribe({channel:p,callback:n,presence:function(e){e.occupancy>1&&(document.getElementById("unit").textContent="doodlers"),document.getElementById("occupancy").textContent=e.occupancy;var t=document.getElementById("occupancy").parentNode;t.classList.add("anim"),t.addEventListener("transitionend",function(){t.classList.remove("anim")},!1)}}),drawHistory&&v.history({channel:p,count:50,callback:function(e){v.each(e[0],n)}});var y=!1,b=[]}();
